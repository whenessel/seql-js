# Visual Diagnostic Diagram

## Component Order Flow

### Current (Broken) Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    stringifyNode()                          â”‚
â”‚                                                             â”‚
â”‚  1. result = "form"                                        â”‚
â”‚                                                             â”‚
â”‚  2. Prepare attributes                                      â”‚
â”‚     finalAttrs = ["data-seql-id=\"seql-el-17\""]          â”‚
â”‚                                                             â”‚
â”‚  3. âŒ ADD ATTRIBUTES FIRST                                 â”‚
â”‚     result += "[data-seql-id=\"seql-el-17\"]"             â”‚
â”‚     result = "form[data-seql-id=\"seql-el-17\"]"          â”‚
â”‚                                                             â”‚
â”‚  4. âŒ ADD CLASSES SECOND                                   â”‚
â”‚     result += ".glass-card"                                â”‚
â”‚     result = "form[data-seql-id=\"seql-el-17\"].glass-card"â”‚
â”‚                                                             â”‚
â”‚  5. ADD POSITION                                           â”‚
â”‚     result += "#2"                                         â”‚
â”‚     result = "form[data-seql-id=\"seql-el-17\"].glass-card#2"â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ parseSEQL()
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     parseNode()                             â”‚
â”‚                                                             â”‚
â”‚  Input: "form[data-seql-id=\"seql-el-17\"].glass-card#2"   â”‚
â”‚                                                             â”‚
â”‚  1. Parse tag: "form" âœ…                                    â”‚
â”‚     remaining = "[data-seql-id=\"seql-el-17\"].glass-card#2"â”‚
â”‚                                                             â”‚
â”‚  2. Parse classes (expects .class) âŒ                       â”‚
â”‚     Match: /^\.([a-zA-Z][a-zA-Z0-9-_]*)/                  â”‚
â”‚     No match! (remaining starts with "[")                  â”‚
â”‚                                                             â”‚
â”‚  3. Parse attributes âœ…                                     â”‚
â”‚     Match: /^\[([^\]]+)\]/                                â”‚
â”‚     Found: [data-seql-id=\"seql-el-17\"]                  â”‚
â”‚     remaining = ".glass-card#2"                            â”‚
â”‚                                                             â”‚
â”‚  4. Parse position (expects #N) âŒ                          â”‚
â”‚     Match: /^#(\d+)/                                       â”‚
â”‚     No match! (remaining starts with ".")                  â”‚
â”‚                                                             â”‚
â”‚  5. ğŸ’¥ ERROR: Unexpected content ".glass-card#2"           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Fixed Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    stringifyNode()                          â”‚
â”‚                                                             â”‚
â”‚  1. result = "form"                                        â”‚
â”‚                                                             â”‚
â”‚  2. Prepare attributes                                      â”‚
â”‚     finalAttrs = ["data-seql-id=\"seql-el-17\""]          â”‚
â”‚                                                             â”‚
â”‚  3. âœ… ADD CLASSES FIRST                                    â”‚
â”‚     result += ".glass-card"                                â”‚
â”‚     result = "form.glass-card"                             â”‚
â”‚                                                             â”‚
â”‚  4. âœ… ADD ATTRIBUTES SECOND                                â”‚
â”‚     result += "[data-seql-id=\"seql-el-17\"]"             â”‚
â”‚     result = "form.glass-card[data-seql-id=\"seql-el-17\"]"â”‚
â”‚                                                             â”‚
â”‚  5. ADD POSITION                                           â”‚
â”‚     result += "#2"                                         â”‚
â”‚     result = "form.glass-card[data-seql-id=\"seql-el-17\"]#2"â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ parseSEQL()
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     parseNode()                             â”‚
â”‚                                                             â”‚
â”‚  Input: "form.glass-card[data-seql-id=\"seql-el-17\"]#2"   â”‚
â”‚                                                             â”‚
â”‚  1. Parse tag: "form" âœ…                                    â”‚
â”‚     remaining = ".glass-card[data-seql-id=\"seql-el-17\"]#2"â”‚
â”‚                                                             â”‚
â”‚  2. Parse classes âœ…                                        â”‚
â”‚     Match: /^\.([a-zA-Z][a-zA-Z0-9-_]*)/                  â”‚
â”‚     Found: "glass-card"                                    â”‚
â”‚     remaining = "[data-seql-id=\"seql-el-17\"]#2"          â”‚
â”‚                                                             â”‚
â”‚  3. Parse attributes âœ…                                     â”‚
â”‚     Match: /^\[([^\]]+)\]/                                â”‚
â”‚     Found: [data-seql-id=\"seql-el-17\"]                  â”‚
â”‚     remaining = "#2"                                       â”‚
â”‚                                                             â”‚
â”‚  4. Parse position âœ…                                       â”‚
â”‚     Match: /^#(\d+)/                                       â”‚
â”‚     Found: 2                                               â”‚
â”‚     remaining = ""                                         â”‚
â”‚                                                             â”‚
â”‚  5. âœ… SUCCESS: All components parsed                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Order Comparison

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  CSS Selector Standard                       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  tag.class[attribute]#position                               â•‘
â•‘   â”‚    â”‚       â”‚         â”‚                                   â•‘
â•‘   1    2       3         4                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              Current SEQL (Broken)                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  tag[attribute].class#position                               â•‘
â•‘   â”‚       â”‚        â”‚      â”‚                                  â•‘
â•‘   1       âŒ 2     âŒ 3    4                                  â•‘
â•‘                                                              â•‘
â•‘  Problem: Parser expects classes before attributes!          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘               Fixed SEQL (Working)                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  tag.class[attribute]#position                               â•‘
â•‘   â”‚    â”‚       â”‚         â”‚                                   â•‘
â•‘   1    âœ… 2    âœ… 3      4                                    â•‘
â•‘                                                              â•‘
â•‘  âœ… Matches CSS selector standard                            â•‘
â•‘  âœ… Matches parser expectations                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## Real-World Example

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    Test Element                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  <form data-seql-id="seql-el-17" class="glass-card">         â•‘
â•‘    <button id="check-out" type="button" class="...">         â•‘
â•‘      Select date                                             â•‘
â•‘    </button>                                                 â•‘
â•‘  </form>                                                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              Current Output (Broken)                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  v1.0: form[data-seql-id="seql-el-17"].glass-card#2          â•‘
â•‘         :: button[id="check-out",text="Select date"]         â•‘
â•‘                                                              â•‘
â•‘  Parser fails at: ".glass-card#2"                            â•‘
â•‘  Error: Invalid node: unexpected content                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘               Fixed Output (Working)                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  v1.0: form.glass-card[data-seql-id="seql-el-17"]#2          â•‘
â•‘         :: button[id="check-out",text="Select date"]         â•‘
â•‘                                                              â•‘
â•‘  âœ… Parser succeeds                                          â•‘
â•‘  âœ… Element resolves correctly                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## Code Location Map

```
File: /src/utils/seql-parser.ts

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  stringifyNode() function              â”‚
    â”‚  Lines: ~221-339                       â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                                        â”‚
    â”‚  Line 221: Function start              â”‚
    â”‚  Line 226: Start tag building          â”‚
    â”‚                                        â”‚
    â”‚  Lines 228-291: âœ… Attribute prep       â”‚
    â”‚  (Keep this section as-is)             â”‚
    â”‚                                        â”‚
    â”‚  Lines 293-302: âœ… finalAttrs filter   â”‚
    â”‚  (Keep this section as-is)             â”‚
    â”‚                                        â”‚
    â”‚  Lines 298-304: ğŸ”„ Attributes block    â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ if (finalAttrs.length > 0) {     â”‚  â”‚
    â”‚  â”‚   result += `[${...}]`;          â”‚  â”‚ â¬‡ï¸ MOVE DOWN
    â”‚  â”‚ }                                â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                        â”‚
    â”‚  Lines 306-320: ğŸ”„ Classes block       â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ if (semantics.classes && ...) {  â”‚  â”‚ â¬†ï¸ MOVE UP
    â”‚  â”‚   result += `.${class}`;         â”‚  â”‚
    â”‚  â”‚ }                                â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                        â”‚
    â”‚  Lines 323-338: âœ… Position block      â”‚
    â”‚  (Keep this section as-is)             â”‚
    â”‚                                        â”‚
    â”‚  Line 339: Function end                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Parser Pattern Matching

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ parseNode() - Line 356                                       â”‚
â”‚ Pattern: tag(.class)*[attr=value,...]#position               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ Step 1: Match tag                                            â”‚
â”‚   Pattern: /^([a-z][a-z0-9-]*)/                             â”‚
â”‚   Input:   "form.glass-card[...]#2"                          â”‚
â”‚   Match:   "form" âœ…                                         â”‚
â”‚   Remaining: ".glass-card[...]#2"                            â”‚
â”‚                                                              â”‚
â”‚ Step 2: Match classes (WHILE LOOP)                           â”‚
â”‚   Pattern: /^\.([a-zA-Z][a-zA-Z0-9-_]*)/                    â”‚
â”‚   Input:   ".glass-card[...]#2"                              â”‚
â”‚   Match:   "glass-card" âœ…                                   â”‚
â”‚   Remaining: "[...]#2"                                       â”‚
â”‚                                                              â”‚
â”‚ Step 3: Match attributes                                     â”‚
â”‚   Pattern: /^\[([^\]]+)\]/                                  â”‚
â”‚   Input:   "[data-seql-id=\"...\"]#2"                       â”‚
â”‚   Match:   [data-seql-id=\"...\"] âœ…                         â”‚
â”‚   Remaining: "#2"                                            â”‚
â”‚                                                              â”‚
â”‚ Step 4: Match position                                       â”‚
â”‚   Pattern: /^#(\d+)/                                         â”‚
â”‚   Input:   "#2"                                              â”‚
â”‚   Match:   "2" âœ…                                            â”‚
â”‚   Remaining: ""                                              â”‚
â”‚                                                              â”‚
â”‚ Step 5: Check remaining                                      â”‚
â”‚   if (remaining.trim()) â†’ throw error                        â”‚
â”‚   remaining = "" â†’ âœ… SUCCESS                                â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Summary Table

| Component  | Generator Order (Before) | Generator Order (After) | Parser Order | Match? |
|------------|-------------------------|------------------------|--------------|--------|
| Tag        | 1                       | 1                      | 1            | âœ…     |
| Attributes | **2** âŒ                | **3** âœ…               | 3            | âœ…     |
| Classes    | **3** âŒ                | **2** âœ…               | 2            | âœ…     |
| Position   | 4                       | 4                      | 4            | âœ…     |
