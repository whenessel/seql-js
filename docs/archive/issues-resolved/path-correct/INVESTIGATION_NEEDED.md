# –¢—Ä–µ–±—É–µ—Ç—Å—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

## –°—Ç–∞—Ç—É—Å
üî¥ **CRITICAL BUG FOUND**

–°–µ–ª–µ–∫—Ç–æ—Ä—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –Ω–∞—Ö–æ–¥—è—Ç –ø–æ 1 —ç–ª–µ–º–µ–Ω—Ç—É, –ù–û —ç—Ç–æ **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã**!

## –ü—Ä–æ–±–ª–µ–º–∞

### Date 18
- **XPath (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π):** `/html/body/div[3]/div/div/div/div/table/tbody/tr[4]/td[1]` ‚Üí —Å—Ç—Ä–æ–∫–∞ 4, —è—á–µ–π–∫–∞ 1
- **–ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è:** –Ø—á–µ–π–∫–∞ —Å –¥–∞—Ç–æ–π **18**
- **–ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä:** –Ø—á–µ–π–∫–∞ —Å –¥–∞—Ç–æ–π **1** (!)

### Date 31
- **XPath (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π):** `/html/body/div[3]/div/div/div/div/table/tbody/tr[5]/td[7]` ‚Üí —Å—Ç—Ä–æ–∫–∞ 5, —è—á–µ–π–∫–∞ 7
- **–ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è:** –Ø—á–µ–π–∫–∞ —Å –¥–∞—Ç–æ–π **31** –≤ —Å—Ç—Ä–æ–∫–µ 5
- **–ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä:** –Ø—á–µ–π–∫–∞ —Å –¥–∞—Ç–æ–π **31** –≤ —Å—Ç—Ä–æ–∫–µ 1 (!)

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### –ì–∏–ø–æ—Ç–µ–∑–∞ 1: querySelector('.rdp-day') –Ω–∞—Ö–æ–¥–∏—Ç –Ω–µ —Ç–æ—Ç —ç–ª–µ–º–µ–Ω—Ç

–í –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–Ω–æ–ø–æ–∫ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Ç–µ–∫—Å—Ç–æ–º:
```
Row 1: [28] [29] [30] [31] [1] [2] [3]  ‚Üê —Å–µ—Ä—ã–µ –¥–∞—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ + –Ω–∞—á–∞–ª–æ —è–Ω–≤–∞—Ä—è
Row 2: [4]  [5]  [6]  [7]  [8] [9] [10]
Row 3: [11] [12] [13] [14] [15] [16] [17]
Row 4: [18] [19] [20] [21] [22] [23] [24]
Row 5: [25] [26] [27] [28] [29] [30] [31]
```

–ü—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–æ —Ç–µ–∫—Å—Ç—É "31":
- –ü–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π: **row 1, cell 4** (—Å–µ—Ä–∞—è –¥–∞—Ç–∞ –∏–∑ –¥–µ–∫–∞–±—Ä—è)
- –ù—É–∂–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç: **row 5, cell 7** (31 —è–Ω–≤–∞—Ä—è)

### –ì–∏–ø–æ—Ç–µ–∑–∞ 2: DSL –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –≤—Ö–æ–¥–Ω–æ–º —ç–ª–µ–º–µ–Ω—Ç–µ

```javascript
// –≠—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç –ü–ï–†–í–´–ô —ç–ª–µ–º–µ–Ω—Ç —Å —Ç–µ–∫—Å—Ç–æ–º "18"
const cell = Array.from(document.querySelectorAll('.rdp-day'))
  .find(el => el.textContent.trim() === '18');
```

–ï—Å–ª–∏ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –µ—Å—Ç—å —Å–µ—Ä—ã–µ –¥–∞—Ç—ã, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ —Ç–∞ –¥–∞—Ç–∞!

### –ì–∏–ø–æ—Ç–µ–∑–∞ 3: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ table/tbody/tr –Ω–∞—Ä—É—à–µ–Ω–∞

–í–æ–∑–º–æ–∂–Ω–æ calendar –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- `<div role="grid">` –≤–º–µ—Å—Ç–æ `<table>`
- –ü–ª–æ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö `<tr>`
- –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é —Å—Ç—Ä–æ–∫

## –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (ANALYZE_STRUCTURE.md)

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- –†–µ–∞–ª—å–Ω—É—é HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- –°–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Ç–µ–∫—Å—Ç–æ–º
- –ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç querySelector
- –ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç XPath

### 2. Debug –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (DEBUG_WRONG_ELEMENT.md)

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å—Ä–∞–≤–Ω–∏—Ç:
- XPath —ç–ª–µ–º–µ–Ω—Ç (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
- querySelector —ç–ª–µ–º–µ–Ω—Ç (–Ω–∞–π–¥–µ–Ω–Ω—ã–π)
- Selector matched —ç–ª–µ–º–µ–Ω—Ç (—Ä–µ–∑—É–ª—å—Ç–∞—Ç)

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –®–∞–≥ 1: –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–∑ ANALYZE_STRUCTURE.md

–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç. –≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É DOM.

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –ø–æ–∫–∞–∂–µ—Ç:**
```
--- Date 18 Analysis ---
1. XPath element (TD):
   Tag: TD
   Text content: 18
   Position: Row 4, Cell 1

5. Found by text "18" in .rdp-day:
   Element: <button class="rdp-day">18</button>
   Same as button in TD: false  ‚Üê ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê –ó–î–ï–°–¨!

Found element position: Row X, Cell Y  ‚Üê –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
```

### –®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–∑ DEBUG_WRONG_ELEMENT.md

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–µ—Ç–∞–ª—å–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç –≤—Å–µ —Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞.

### –®–∞–≥ 3: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å root cause

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –º—ã —É–∑–Ω–∞–µ–º:
1. –ï—Å—Ç—å –ª–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Ç–µ–∫—Å—Ç–æ–º?
2. –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ querySelector –Ω–∞—Ö–æ–¥–∏—Ç —ç–ª–µ–º–µ–Ω—Ç?
3. –ì–¥–µ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞?

## –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—ã–µ –¥–∞—Ç—ã

```javascript
// –í–º–µ—Å—Ç–æ:
const cell = Array.from(document.querySelectorAll('.rdp-day'))
  .find(el => el.textContent.trim() === '18');

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
const cell = Array.from(document.querySelectorAll('.rdp-day:not(.rdp-day_disabled)'))
  .find(el => el.textContent.trim() === '18');
```

### –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å XPath –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

```javascript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å XPath –≤–º–µ—Å—Ç–æ querySelector
function getByXPath(xpath) {
  return document.evaluate(xpath, document, null,
    XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
}

// –î–ª—è –¥–∞—Ç—ã 18
const correctCell18 = getByXPath('/html/body/div[3]/div/div/div/div/table/tbody/tr[4]/td[1]');
const button18 = correctCell18.querySelector('button');
```

### –†–µ—à–µ–Ω–∏–µ 3: –£–ª—É—á—à–∏—Ç—å –ø–æ–∏—Å–∫ –ø–æ –ø–æ–∑–∏—Ü–∏–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ

```javascript
// –ù–∞–π—Ç–∏ table, –∑–∞—Ç–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏ —è—á–µ–π–∫—É
const tbody = document.querySelector('table.rdp-table tbody');
const rows = Array.from(tbody.querySelectorAll('tr'));
const targetRow = rows[3]; // Row 4 (0-indexed)
const targetCell = targetRow.children[0]; // Cell 1 (0-indexed)
const button = targetCell.querySelector('button');
```

### –†–µ—à–µ–Ω–∏–µ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ button –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ

```javascript
const cells = Array.from(document.querySelectorAll('.rdp-day'))
  .filter(el => {
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —ç—Ç–æ –Ω–µ —Å–µ—Ä–∞—è –¥–∞—Ç–∞
    return !el.classList.contains('rdp-day_outside');
  });
const cell18 = cells.find(el => el.textContent.trim() === '18');
```

## –°–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

1. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
2. üìã –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–∑ ANALYZE_STRUCTURE.md
3. üìã –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–∑ DEBUG_WRONG_ELEMENT.md
4. üìä –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥
5. üîß –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
6. üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –≤ dom-dsl –ø–∞–∫–µ—Ç–µ

## –§–∞–π–ª—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- **ANALYZE_STRUCTURE.md** - –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã DOM
- **DEBUG_WRONG_ELEMENT.md** - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **MANUAL_TEST_COMMANDS.md** - –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

---

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ CRITICAL
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç—Å—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
**–î–∞—Ç–∞:** 2026-01-16
